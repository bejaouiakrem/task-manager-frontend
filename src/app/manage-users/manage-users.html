<div class="manage-users-bg min-vh-100 py-5 d-flex align-items-center justify-content-center">
  <div class="manage-users-card card shadow-lg rounded-4 border-0 w-100">
    <div class="card-header bg-primary text-white rounded-top-4 py-4 text-center border-0">
  <i class="bi bi-people-fill me-2 manage-users-header-icon"></i>
  <span class="h4 mb-0 align-middle">Manage Users</span>
    </div>
    <div class="card-body p-4 p-md-5">
      @if (isLoading) {
        <div class="spinner-container text-center my-5">
          <mat-spinner diameter="50"></mat-spinner>
          <p class="mt-3">Loading users...</p>
        </div>
      } @else if (users.length === 0) {
        <div class="no-users-message text-center my-5">
          <i class="bi bi-info-circle-fill text-primary manage-users-info-icon"></i>
          <div class="mt-2 fs-5">No users found</div>
        </div>
      } @else {
        <div class="table-responsive table-container">
          <table mat-table [dataSource]="users" class="mat-elevation-z8 w-100">
            <!-- Username Column -->
            <ng-container matColumnDef="username">
              <th mat-header-cell *matHeaderCellDef>Username</th>
              <td mat-cell *matCellDef="let user">{{ user.username }}</td>
            </ng-container>

            <!-- Email Column -->
            <ng-container matColumnDef="email">
              <th mat-header-cell *matHeaderCellDef>Email</th>
              <td mat-cell *matCellDef="let user">{{ user.email }}</td>
            </ng-container>

            <!-- Role Column -->
            <ng-container matColumnDef="role">
              <th mat-header-cell *matHeaderCellDef>Role</th>
              <td mat-cell *matCellDef="let user">
                <span class="badge bg-secondary text-uppercase">{{ user.role || 'USER' }}</span>
              </td>
            </ng-container>

            <!-- Status Column -->
            <ng-container matColumnDef="status">
              <th mat-header-cell *matHeaderCellDef>Status</th>
              <td mat-cell *matCellDef="let user">
                <span [ngClass]="getStatusClass(user.enabled)" class="status-badge">
                  {{ getStatusText(user.enabled) }}
                </span>
              </td>
            </ng-container>

            <!-- Projects Column -->
            <ng-container matColumnDef="projects">
              <th mat-header-cell *matHeaderCellDef>Projects</th>
              <td mat-cell *matCellDef="let user">{{ user.projectCount || 0 }}</td>
            </ng-container>

            <!-- Actions Column -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>Actions</th>
              <td mat-cell *matCellDef="let user">
                <button type="button" class="btn btn-sm btn-outline-primary me-1" (click)="editUser(user.username)" title="Edit user">
                  <i class="bi bi-pencil-square"></i>
                </button>
                <button type="button" class="btn btn-sm btn-outline-danger" (click)="deleteUser(user)" title="Delete user">
                  <i class="bi bi-trash"></i>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </div>
      }
    </div>
  </div>
</div>